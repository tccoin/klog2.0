<link rel="import" href="../bower_components/polymer/polymer-element.html">
<link rel="import" href="klog-data-article.html">

<dom-module id="klog-editor-moon">
  <template>
    <style>
      :host {
        display: block;
      }
    </style>
    <klog-data-article id="data" article-id="{{articleId}}" disabled></klog-data-article>
    <moon-editor markdown="{{markdown}}"></moon-editor>

  </template>

  <script type="module" src="moon-editor.js"></script>
  <script>
    class KlogEditorMoon extends Polymer.Element {

      static get is() { return 'klog-editor-moon'; }

      static get properties() {
        return {
          articleId: {
            type: String,
            observer: '_onArticleIdChanged'
          },
          articleData: Object
        }
      }

      ready() {
        super.ready();

        this.markdown = `@(Bin)[]

# 测试用笔记

![](https://storage.krrr.party/storage/klog2/5A776A3C-82FB-4E63-9AA8-E025F8139F05.400ffe7029457ccc362f6412583676b5.jpeg)

> 没忍住一口气把画册看完了（其实是两口气

- 123
  - 456
- 789
- [ ] 123
  `;

        // load event
        this.$.data.addEventListener('success', e => {
          console.log(e.detail.data);
          this.set("articleData", e.detail.data);
        });
        this.$.data.addEventListener('error', e => {
          console.log("Article failed to load.");
        });
      }

      /* load event*/

      _onArticleIdChanged(articleId, _articleId) {
        if (_articleId) console.error("Article Id must not be changed.");
      }

    }

    window.customElements.define(KlogEditorMoon.is, KlogEditorMoon);

    /*
    * Test:
    * 是否可以打开别人的文章
    */
  </script>

</dom-module>